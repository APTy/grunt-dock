# Grunt-Dock | NGINX proxy sample

A sample that shows how to configure 2 containers linked together.

* **node**: a container that embeds a node app  
* **nginx**: a container that embeds a NGINX instance which is linked to the node container. It serves as a reverse proxy.

Unlike to the simple example, this Grunfile is configured with a Grunt environment target: dev. So Grunt-Dock commands must be like:

```bash
grunt dock:dev:XXX
```

**Note for Mac OS X: the volume must be in /Users in order to work properly (Docker limitation).**

## Getting started:

Update the options to connect with Docker.
For supported options, see [dockerode](https://github.com/apocas/dockerode#getting-started).

For example, in a Mac environment with Boot2Docker, it should like:
```javascript
docker: {
  protocol: 'https',
  host: '192.168.59.103',
  port: '2376',
  
  ca: fs.readFileSync('PATH_TO_CA_PEM'),
  cert: fs.readFileSync('PATH_TO_CERT_PEM'),
  key: fs.readFileSync('PATH_TO_KEY_PEM')
}
```

Next, you can use the container like this:

```bash
# To build the 2 images, enter:
grunt dock:dev:build

# To start the 2 images, use:
grunt dock:dev:start

# Other options: stop/kill/logs/pause/unpause

# Or, for 1 container:
grunt dock:dev:build:nginx
grunt dock:dev:build:node


```

You can then test the container by accessing [http://localhost:8081](http://localhost:8081) in your browser. It should display a NGINX html page (meaning that NGINX started properly). 

Then, you can access to the Node.js app: [http://localhost:8081/node](http://localhost:8081/node) through the NGINX proxy. It will display a page generated by the node app.js code.

**Note**: for Boot2Docker user, you will need to add a port forwarding in your VM.

